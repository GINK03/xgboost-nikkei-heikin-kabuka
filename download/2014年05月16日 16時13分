

対策ソフトで検知不能、ネット銀行被害最悪に


2014年05月16日 16時13分










　ネットバンキングからお金を盗まれる被害が、史上最悪の１４億１７００万円となった。背景には、ネットバンキング不正送金用のウイルスが、自分を隠す技術を進化させていることがある。ウイルス対策ソフトが検知できない上に、セキュリティー会社の解析を阻止しようとしている。（ITジャーナリスト・三上洋）
不正送金１４億円、４か月あまりで昨年の被害額突破





三井住友銀行によるネットバンキング不正送金の注意画面。正規サイトにアクセスした場合に、本物そっくりの偽ポップアップ画面が出る




        AD2.init(ads.p_rectangle);
        

        AD2.cAds();
        

AD2.dBanner(0,'prect');




　ネットバンキングからお金を盗まれる被害が、急激に増えている。警察庁が５月１５日にまとめたところによると、５月９日までのネットバンキング不正送金の被害額は１４億１７００万円。史上最悪だった昨年は１４億６００万円だったから、わずか４か月強で昨年の被害額を超えたことになる。
　警察庁によると、被害件数は８７３件で、鳥取県以外の全国４６都道府県で被害が発生。また被害に遭った金融機関は５８にも及んでいる。今までは大手都市銀行の被害が目立っていたが、地方銀行や信用組合の被害が増えている。
　最近の傾向として目立つのは、法人口座が狙われていることだ。企業のパソコンがウイルス感染し、そのパソコンでネットバンキングを利用したことから不正送金されてしまう。昨年の法人被害は全体の４％だったが、今年は１２％、１０９件に増えた。
　この結果として、１件あたりの被害額も増えている。昨年に比べて５２％増えて、１件あたり１６２万円のお金が盗まれている。法人の被害額は全体で４億８０００万円もあり、企業でのネットバンキング不正送金の被害が甚大なことがわかるだろう。
　ネットバンキングからの現金盗み出しについては、この連載で何度か詳しく取り上げて
いる。
　・緊急警告！　ネットバンキング被害急増とその対策
　・日本のネットバンキングを狙う「IEゼロデイ」攻撃
　・ネットバンキング不正被害の背景とは？

　今までの動きを簡単にまとめると、２０１２年以前は、偽サイトによるフィッシング攻撃によるもので被害は小さかった。２０１３年から正規のサイト上で偽のポップアップを出す手口によって、急激に被害が拡大。原因は不正送金専用のウイルスに感染しているためで、感染元は企業や一般のウェブサイトだった。犯人によって改ざんされた企業や一般のウェブサイトを見ただけで感染する「ドライブバイダウンロード」によるものだ。

バンキングマルウェア「Citadel（シタデル）」に見る巧妙な隠匿手口





ＦＦＲＩ・鵜飼裕司氏によるバンキングマルウェア・Ｃｉｔａｄｅｌの感染動作。感染すると端末固有の情報を取り込んだ、そのパソコンでしか動かないウイルスになる





ＦＦＲＩ・鵜飼裕司氏によるＣｉｔａｄｅｌの解析。感染前と感染後で違いがある


　では不正送金には使われるウイルスは、どんなものなのか。セキュリティー会社・FFRIの取締役社長・鵜飼裕司氏が、「バンキングマルウェア『Citadel』の解析から得られた近年のマルウェアの動向と対策」というテーマで講演を行った。セキュリティーの展示会「情報セキュリティEXPO２０１４春」での専門セミナーだ。
　鵜飼氏はまず「ネットバンキング不正送金は、他のサイバー攻撃と異なり、すぐに現金が手に入る犯罪。現金に直結しているため、手口の進化スピードが速い」として、バンキングマルウェア「Citadel」を例として取り上げた。
　「Citadel（シタデル）」とは、ネットバンキング向けのウイルス作成ツールとして有名な「Zeus（ゼウス）」を基に開発されたもの。日本では２０１３年後半からCitadelの被害が増え始め、本連載でも紹介した（ネットバンク不正送金　Gmailからパスワード詐取：サイバー護身術）
　Citadelの特徴は、感染前と感染後で別のウイルスとなり、さらに「そのパソコン専用のウイルス」になることだ。
　Citadelは最初の形態＝感染前マルウェアでは共通のもの。しかしパソコンに入り込み、実行すると感染後のマルウェアは、一つ一つまったく異なるものになる（動作は同じだが、外部からの見た目が異なる）。
　それはパソコン１台ごとの固有の情報を取り込むためだ。具体的には、１台ごとに異なるランダムなディレクトリー名を作ること、ドライブの特定の値を取り込むこと、これによって固有の情報を入れ込んだウイルスを作成する。
　鵜飼氏によると「感染前のCitadelはウイルス対策ソフトで検知できる。しかし感染後のCitadelは、一つ一つ異なる固有のウイルスになるため、ウイルス対策ソフトでの検知はほぼできない」としている。オンリーワンのウイルスなのだから、パターン検知方式の対策ソフトでは発見できないのである。
　この特徴は、セキュリティー会社による解析を阻むことにもなる。鵜飼氏は感染者の自宅に行って検体を持って帰ったものの、その検体は別のパソコンで動作しなかったそうだ。一つ一つ固有のウイルスとなっており、環境が異なると動作しなくなるしくみになっていたからだ。
　さらに解析を阻む機能をいくつか持っている。たとえば解析でよく使われる仮想環境（VMware、VitualBoxなど）では動作しない、解析のためのツールがあると動作しないといった機能がある。セキュリティー会社による解析を阻止するために、様々な手段を用意している。
　ウイルス作成者と、セキュリティー会社の戦いとも言えそうだ。これについて鵜飼氏は「以前はウイルスの解析は２～３時間もあれば終わるだろうと考えていたが、今ではもっと時間がかかることがある」と述べている。
ウイルス対策ソフトでは検知できないのが前提

　このようにネットバンキング不正送金ウイルスは、対策ソフトに見つからない・解析されないための機能があり、その内容も日々進化している。鵜飼氏は「機能が多く、進化も速いことから、１人が作っているのではなく、複数の人間によるプロジェクトで作っていると思われる」と分析している。
　ネットバンキング不正送金の被害は、今後も増える可能性が高い。日本では４か月あまりで１４億円の被害となったが、ヨーロッパでは２０１２年にもっと規模の大きいネットバンキング不正送金事件が起きている。「Operation High Roller（オペレーションハイローラー）」と呼ばれる一連の事件で、２か月あまりで最大で約２０００億円もの被害が出た。この事件では、国外送金・不正送金の自動化などによって被害が拡大した。同様のことが日本でも起きれば、桁が一つ増える数百億円規模の不正送金が起きることも考えられる。
　銀行側の対策が急務だが、われわれ一般ユーザーも自分が被害に遭うことを想定しておくべきだ。対策として、鵜飼氏は以下のようにまとめた。

●OS、アプリケーションを最新バージョンに
　脆弱(ぜいじゃく)性を突いた攻撃で感染しないために、OS・ブラウザー・Flash・PDFなどのソフトウェアを自動更新にして常に最新にする
●ふるまい検知機能があるウイルス対策ソフトを導入する
　パターン検知方式のウイルス対策ソフトでは役に立たない。プログラムの動きなどを監視する「ふるまい検知機能」がある対策ソフトにする

　そして、企業ではネットバンキングにアクセスするパソコンは専用にしたほうがいいだろう、と鵜飼氏は述べている。通常の業務に使うパソコンでは、ウェブサイト表示やメール受信によってウイルスに感染して不正送金の被害に遭う可能性があるからだ。われわれ個人ユーザーも、ネットバンキングにアクセスするパソコンは、特にセキュリティーに注意したいものだ。

2014年05月16日 16時13分
Copyright © The Yomiuri Shimbun



