

表示だけでウイルス感染、正規サイトに不正広告の「手口」


2015年09月04日 15時09分










　７月以降、ウェブサイトの広告を表示するだけでウイルス感染する事例が多発している。国内から９００万件以上のアクセスがあると推測され、オンライン銀行詐欺ツールやランサムウェアが忍び込んでいる可能性が高い。（ＩＴジャーナリスト・三上洋）
ウェブサイトのバナー広告表示→自動転送されて脆弱性攻撃サイトへ→ウイルス感染





（図１）マルウェア感染させる不正広告の例。パソコンで使っているソフトに脆弱性が残っている場合、表示しただけで感染する（トレンドマイクロによる）




        AD2.init(ads.p_rectangle);
        

        AD2.cAds();
        

AD2.dBanner(0,'prect');




　一般ユーザーが被害にあう、厄介なウイルス感染の手法が広まっている。ウェブサイトのバナー広告を使ったもので、最悪の場合は表示するだけでウイルス感染し、ネットバンキングからお金を盗みとられるなどの被害が出てしまう。
　この広告経由のウイルス感染（マルウェア感染）をリポートしたのはセキュリティー大手のトレンドマイクロで、２０１５年９月２日に「不正広告に日本から９００万アクセス、金銭狙う攻撃への誘導が日本でも顕著に」という注意喚起のブログ記事を発表した。
　それによると、不正広告は６００以上の正規サイトに表示され、日本国内で少なくとも９００万件のアクセスがあったとのこと（２０１５年７月１日から８月２１日まで。トレンドマイクロのソフトの利用者での統計）。海外の４つの広告配信業者（広告ホスティング事業者）から不正広告が配信されていた。
　国内の有名サイトのほか、まとめサイト・アダルトサイト、ニュースサイト、ポイントや動画のウェブサイト、オンラインゲームなどに不正広告が表示されていた。トレンドマイクロによれば「不正広告を配信したサーバーへのアクセスは、日本からのアクセスが全体の５割から８割を占めており、特に日本向けサイトに配信されることを目的とした広告であったものと推測されます」としている。
　図１の画像は、問題のバナー広告だ。上は英語の広告だが、下は日本語のＦＸ（外国為替証拠金取引）業者を装った広告である。日本国内からアクセスの多いウェブサイトに表示されており、表示しただけでウイルス感染させるサイトに自動転送されていた。オンライン銀行詐欺ツールや、人質ソフト・ランサムウェアに感染し、閲覧したユーザーのパソコンが被害にあう可能性がある。
　なぜこんなことが起きるのだろうか、順を追って見ていこう。
ウェブサイトの不正広告表示でユーザーが被害にあう流れ





トレンドマイクロが確認した不正広告の手口。攻撃者は、脆弱性攻撃サイトへ自動誘導する広告を出していた


１：攻撃者がマルウェア感染させるための脆弱性攻撃サイトを用意
　攻撃者が各種ソフトの脆弱(ぜいじゃく)性（弱点・問題点）を攻撃し、マルウェアに感染させるためのサイトを用意する。
２：攻撃者がお金を払って広告を出す、もしくはサイバー攻撃によって不正な広告を出す
　広告を各サイトに配信する業者＝広告ホスティング業者に対し、お金を払うかサイバー攻撃によって不正な広告を出す。広告は犯人が用意した脆弱性攻撃サイトへ自動転送されるしくみ。
３：広告が正規のサイトに大量配信される

　バナー広告などを載せている正規のサイトに、不正な広告が表示される。今回の不正な広告は、少なくとも６００の正規サイトに表示された（トレンドマイクロ調査）。
４：閲覧した一般ユーザーのパソコンで被害
　不正広告が出ている正規サイトを一般ユーザーが表示。利用しているソフトが古く脆弱性が残っている場合は、表示しただけでマルウェア感染してしまう。
５：犯人はオンライン銀行詐欺ツールやランサムウェアで金儲け
　一般ユーザーのパソコンに、オンライン銀行詐欺ツール（ネットバンキング不正送金）や、ランサムウェア（ファイルを勝手に暗号化し金銭を要求する脅迫ソフト）が忍び込む。犯人は金儲(もう)けが目的である。
　つまりネット広告の内容はどんなものでもよく、犯人の目的は不正な広告を表示させることのみ。一般ユーザーは日本語の正規サイトを表示しており、かつ見ただけでは不正な広告だとわからないので、気づかないうちに被害が出ている可能性がある。
以前から広告利用の攻撃はあったが、これほど大規模な攻撃は初めて





トレンドマイクロが観測した脆弱性攻撃サイトへの誘導経路。以前は正規サイトの改ざんが多かったが、２０１５年７月以降は不正広告によるものが多くなった


　このようなネット上の広告を使ったマルウェア感染は以前からあった。たとえば２０１４年６月には、YouTubeやAmazonの広告に不正な広告が表示され、閲覧者に自動的に不正なファイルをダウンロードさせていた。２０１４年１０月には、YouTubeの広告にも不正なものがみつかっており、閲覧者を攻撃するサイトへ誘導するものだった。
　この広告を通じたマルウェア感染の手法は「マルバタイジング」と呼ばれている。マルバタイジングは、以前から日本でも小規模な事例はあったが、今回のような大規模な日本向けの攻撃は初めてと言っていいかもしれない。
　攻撃者にとって、広告を利用するメリットはいくつかある。

●より多くの正規サイトへ一気に配信できる
　正規サイトを改ざんする手法では、そのサイトに直接アクセスする訪問者のみの被害になる。しかし不正広告なら、アドネットワークによって多数の正規サイトで表示されるため、より広範囲・大規模な攻撃が可能になる。
●調査が難しい＝追跡されにくい
　バナー広告は、時間帯・閲覧者の属性・行動履歴などによって異なる広告が出る。そのためセキュリティー企業などが追跡しにくい。同一のＩＰアドレスからアクセスがあった場合には、脆弱性を発動させないなどのしかけもあり、より調査が難しくなっている。
●正規サイトであるがゆえに、多くのユーザーが広告に無防備
　広告が出ているのは、ほとんどが正規サイトであり、ユーザーはマルウェア感染するとは思っていない。またバナー広告があることが日常になっているため、警戒心が薄い。
　このようにネット上の広告が、犯罪者のマルウェア拡散のツールになってしまっている。大手の広告配信事業者は対策を始めているが、今回のような不正広告は繰り返し登場しており、今後も被害が続く可能性が高い。
対策は利用ソフトの自動更新とセキュリティー対策ソフト





不正広告経由で感染するマルウェアの割合。ネットバンキング不正送金を行うオンライン銀行詐欺ツール、パソコンのファイルを勝手に暗号化して元に戻すには金を払えと脅迫するランサムウェアが多くなっている。


　不正広告によるサイバー攻撃を防ぐには、自分が使っているソフトを最新にすること、およびセキュリティー対策ソフトを導入することが重要だ。Windowsはもちろんのこと、Macでも被害にあう可能性があるので注意してほしい。

不正広告によるマルウェア感染への対策

●ソフトウェアを最新にして脆弱性を解消する
　脆弱性を解消する最新バージョンのソフトを使っていれば、不正広告表示だけでは感染しない（未知の脆弱性を攻撃するゼロデイを除く）。特にAdobe Flashが狙われているので、必ず最新版にした上で自動更新にすること。ブラウザー、Java、Adobe Readerなども自動更新の設定にする。
●セキュリティー対策ソフトは必須
　Windowsはもちろんのこと、Macでもセキュリティー対策ソフトが必須の時代になった。危険なウェブサイトをブロックする機能があるセキュリティー対策ソフトを使うこと。
　また、広告配信事業者による対策も欠かせない。不正なスクリプト・不正なサイトへの誘導を含む広告をブロックすること、またサーバーのセキュリティー強化は絶対に必要だ。不正広告は、ネット広告自体の信頼度を下げることになるから、広告配信事業者によるいち早い対策が必要だろう。
　
●参考記事
・不正広告に日本から９００万アクセス、金銭狙う攻撃への誘導が日本でも顕著に：トレンドマイクロセキュリティブログ
・ＮＨＫと芸能人を騙る詐欺広告がＦＢに：サイバー護身術
・「ｉＰｈｏｎｅ７」当選詐欺、広告で誘導か：サイバー護身術

2015年09月04日 15時09分
Copyright © The Yomiuri Shimbun



