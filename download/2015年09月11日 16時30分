

年金機構流出の犯人が新たな手口で国内企業を狙う


2015年09月11日 16時30分










　日本年金機構の流出をしかけた犯罪グループが、さらに日本の企業を狙っている。７月以降も日本国内の企業での被害があるほか、ウェブサイトを表示しただけでウイルス感染させる手法、解析を阻止する手法を使い始めているのだ。（ＩＴジャーナリスト・三上洋）
年金機構流出後の７月中旬に「Emdivi（エンディヴィ）」がさらに活発化





Ｅｍｄｉｖｉ（エンディヴィ）の指令サーバーへの１日あたりのアクセス推移。日本年金機構の被害は５月だったが、７月中旬になっても活発に動いている（カスペルスキーによる）




        AD2.init(ads.p_rectangle);
        

        AD2.cAds();
        

AD2.dBanner(0,'prect');




　日本年金機構の個人情報流出が起きたのは、今年５月のこと。報道が一段落したこともあって、流出事件はおさまったかのように思えるが、実際には攻撃と流出は続いており、さらに活発に動いている気配がある。
　左のグラフは、セキュリティー大手・カスペルスキーの観測による、年金機構で使われたウイルスと同じ種類の「Emdivi（エンディヴィ）」の指令サーバーへのアクセス数だ。日本年金機構がやられたのは５月だが、その後も活動は続き、７月中旬にピークを迎えている。７月中旬には報道も一段落し、流出事件はおさまったかのように見えていたが、犯罪グループの活動は続いているのだ。
　これについてカスペルスキーが、８月２０日に「APT『ブルーターマイト』：新たな手口で感染拡大：カスペルスキーラボ」という分析記事を出した。カスペルスキーでは、日本年金機構などを狙った一連の攻撃を「ブルーターマイト」と呼んでおり、犯罪グループの動きを追いかけている。
　それによると６月までは政府・行政機関、地方自治体、公益団体、大学、銀行、金融サービス、エネルギー、通信、重工、化学、自動車、電機、報道・メディア、情報サービス分野が攻撃対象だったが、７月から新たに医療、不動産、食品、半導体、ロボット、建設、保険、運輸などの企業も攻撃されているとのこと。このブルーターマイトは、日本の組織への攻撃をメインにしており、いずれも日本の企業・組織が狙われているのだ。
　先ほどのグラフで、マルウェアの指令サーバーへのアクセスが増えていることについて「攻撃者が新たな攻撃手法を取り入れたことで、感染の拡大および感染した状態の保持に成功したことに起因していると考えられます」とカスペルスキーは分析している。ブルーターマイトは新たな手口で、さらに日本の企業・組織からの情報盗み出しを狙っている。
ウェブサイト表示だけで感染する「ドライブバイダウンロード」と巧妙な暗号化





一般社団法人のウェブサイトが改ざんされた例。脆弱性のあるソフトウェアを使っている場合、表示しただけでマルウェアに感染する（カスペルスキーによる）


　日本年金機構の情報流出のきっかけとなったのは、標的型攻撃メールだった。社内メールや一般からの問い合わせを装った偽メールを送り、添付ファイルを開かせてウイルス感染させる手法だ。
　しかしカスペルスキーによれば、新たな手口としてウェブサイトを表示しただけで感染させる「ドライブバイダウンロード」が使われているとのこと。一般のサイトを犯人が改ざんし、そこで不正なファイル（ソフトの脆弱(ぜいじゃく)性を突いてウイルス感染させるもの）を置いて攻撃する方法だ。
　右の画像はカスペルスキーが分析記事でサンプルとして紹介しているもので、一般社団法人のウェブサイトが改ざんされている。改ざんされた一般社団法人のトップページを開くと、別のページにある不正なFlashファイルを読みこむようになっていた。Flashの脆弱性（攻撃されるとウイルス感染の原因となる弱点）「CVE-2015-5119」を突くものだ。
　この脆弱性は、イタリアの企業「Hacking Team」から漏えいしたデータでわかったもので、発覚したのは７月１日のこと。日本年金機構の流出から１か月以上も後であり、犯罪グループは最新の攻撃手法を取り入れていることがわかる。
　カスペルスキーでは「改ざんされたサイトの中には政府関係者と関わりのあるウェブサイトも確認されており、水飲み場攻撃として使用されている」と分析している。水飲み場攻撃とは、そのサイトを訪れる人を狙って行うウェブサイト改ざん・攻撃のこと。このサンプルで言えば「一般社団法人のサイトを改ざんしておけば、政府関係の人が閲覧することでマルウェア感染させて、政府関係のサーバーに侵入できるだろう」と犯人が仕掛けていることになる。
標的ごとにカスタマイズされたマルウェアを投入して解析を阻止





改ざんされたサイトのスクリプト（実行文）。特定のＩＰアドレスの人だけを感染させようとしている（カスペルスキーによる）


　さらに犯罪グループは、攻撃が発覚しないように様々な工夫をしている。たとえば上記の水飲み場攻撃では、特定の人だけ感染するように仕掛けられていた。
　左の画像は改ざんされた一般のサイトに置かれていたスクリプト（実行文）で、指定したIPアドレス（インターネット上の住所にあたるもの）の閲覧者だけ実行するようになっている。このIPアドレスに該当しない一般ユーザーは感染しないというしくみだ。
　カスペルスキーによれば「特定の政府組織に属するIPからアクセスした場合にかぎりマルウェアがダウンロードされる設定になっているスクリプトも発見されました」とのこと。これによってマルウェア感染の発覚が遅れる＝解析されにくくなるわけだ。
　また解析を阻止するために、マルウェアは感染した端末ごとにカスタマイズがされていた。一連の攻撃で使われているマルウェア・Emdivi（エンディヴィ）は、通信先などの重要な情報を暗号化している。この暗号化の鍵に、ターゲットの組織のデータを使っていたのだ。具体的には暗号化の鍵に、その端末固有のID（SID＝セキュリティー識別子）を入れていた。





Ｅｍｄｉｖｉ（エンディヴィ）の復号鍵生成フロー。感染した端末だけで動くように、端末のＳＩＤで暗号化していた（カスペルスキーによる）


　つまり、このマルウェアが動作するのは、その端末だけになる。他の環境では動作しない上に、セキュリティー会社による解析も難しくなる。解析したカスペルスキーも手こずったようで「幸運なことに、当社ではいくつかの検体から総当たり攻撃によって復号鍵を入手することができ、C&Cサーバーの通信先、検体の機能等を解析することに成功しました」と述べている。
　このように攻撃者は一つ一つのマルウェアを、端末ごとにカスタマイズし、発覚を遅らせて解析も難しくしている。日本年金機構などの流出では、組織自体が気付くことができずに、多くが外部からの指摘で発覚している。侵入されていることがわからないのは、犯人がこのような巧妙な手段で侵入を隠しているからだろう。
　これらのマルウェア感染への対策としては、以下の３つが大切だ。一般ユーザーの被害も考えられるので、改めて対策を確認してほしい。Windowsはもちろんのこと、Macでも同様の対策が欠かせない。
●マルウェア対策の基本

・ソフトウェアを最新にする　Flash、Adobe Reader、ブラウザー、Javaなどのソフトウェアを最新にする。具体的にはすべて「自動更新」に設定し、表示が出たらすぐに更新すること。
・ウイルス対策ソフトを導入する　怪しい動きをするプログラムを阻止する「ふるまい検知」、問題のあるサイトを表示しないブロック機能（Webレピュテーションなど）があるウイルス対策ソフトを導入する。
・メールの添付ファイルは開かない、リンクはクリックしない　メールの添付ファイルは開かないこと、書かれているリンクはクリックしないことを基本にする。業務上必要な場合は、ダブルチェック（相手への問い合わせ、メール送信元の確認など）をしっかり行うこと。
　今回の攻撃は日本をターゲットにしたものであり、日本の一般サイトが改ざんされている。狙われているのは大企業ばかりではなく、中小企業も攻撃の足場になる可能性があるので注意が必要だ。

●参考記事
・APT「ブルーターマイト」：新たな手口で感染拡大：カスペルスキーラボ
・３４組織で年金機構と同じウイルス感染か：サイバー護身術
・年金機構に続き１０組織でウイルス感染・流出：サイバー護身術
・年金機構流出：３度の判断ミスで流出拡大：サイバー護身術

2015年09月11日 16時30分
Copyright © The Yomiuri Shimbun



