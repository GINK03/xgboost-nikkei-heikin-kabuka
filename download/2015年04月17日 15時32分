

オンライン銀行詐欺ツールで巧妙な新手口


2015年04月17日 15時32分










　ネットバンキング不正送金の被害が続く中、新たな手口の詐欺ツールがみつかっている。ウイルスの常駐なしで、プロキシサーバー（中継サーバー）の設定を書き換えることで、情報盗み取り・不正送金を行う巧妙なものだ。（ＩＴジャーナリスト・三上洋）
プロキシサーバー利用の詐欺ツール「ＷＥＲＤＬＯＤ」





新たなオンライン銀行詐欺ツール「ＷＥＲＤＬＯＤ」の攻撃シナリオ。マルウェアを常駐させず、プロキシ設定の変更で情報を盗み取ろうとする（トレンドマイクロによる）




        AD2.init(ads.p_rectangle);
        

        AD2.cAds();
        

AD2.dBanner(0,'prect');





　セキュリティー大手・トレンドマイクロが「日本を標的とする新たなオンライン銀行詐欺ツール『ＷＥＲＤＬＯＤ（ワードロッド）』の手口を解説」という注意喚起のブログ記事を出した。今までにない新たな手口のオンライン銀行詐欺ツール「ＷＥＲＤＬＯＤ」について、巧妙な手口を詳しく分析したものだ。
　ネットバンキング不正送金に使われるマルウェア（トレンドマイクロでは「オンライン銀行詐欺ツール」）には、今まで「ＺＢＯＴ」「ＶＡＷＴＲＡＫ」などがあり、これらのマルウェアにより昨年は史上最悪の２９億１千万円の被害が出ている（参照「史上最悪２９億１千万円　ネット銀行被害の手口」）。いずれもマルウェアが感染者のパソコンに常駐し、銀行へのアクセスを監視し、情報盗み取り・不正送金を行うものだった。
　しかしトレンドマイクロが分析している「ＷＥＲＤＬＯＤ」は、マルウェアの常駐なしで動く巧妙なものだ。
「ＷＥＲＤＬＯＤ（ワードロッド）」の特徴

１：マルウェアの常駐や起動が不要
２：プロキシサーバー（中継サーバー）の設定を書き換え、犯人が用意したプロキシサーバーを経由させる
３：銀行との接続を証明するルート証明書を偽造（ＳＳＬ／ＴＬＳ）





不正なプロキシ設定「ｐｒｏｘｙ．ｐａｃ」を参照するよう変更されたＷｉｎｄｏｗｓのレジストリ項目（トレンドマイクロによる）



　マルウェアの常駐なしで動くことに驚かされる。セキュリティー対策ソフトで検知しにくくするための犯人側の悪知恵と考えてもいいだろう。
　犯人はブラウザーのプロキシサーバー設定を書き換えて、犯人が用意したサーバーを経由させる。さらに偽のＳＳＬサーバー証明書によって、正常の通信のように見せかける。これによりＩＤ・パスワードなどの情報が犯人に盗み取られるほか、犯人がサイトの書き換えもできるようになってしまう。
　記事を執筆したセキュリティースペシャリストの木村仁美氏は「この手口は、弊社が２０１４年７月以降にエメンタル作戦として発表した内容の一部と類似しており、海外で確認された手口が日本に上陸した形であるともみられます。」と分析している。
　「エメンタル作戦」はスイス・オーストリア・スウェーデンで発見されたオンライン銀行詐欺で、マルウェアの常駐なしで、ユーザーのインターネット設定（ＤＮＳ設定）を書き換えるものだった。ヨーロッパでの手口が、日本向けに応用されていると考えられる（参照「金融機関を狙うサイバー攻撃『エメンタル作戦』の脅威（トレンドマイクロ）」）。
メール経由で感染、邦銀サイト接続が犯人のサーバー経由に





スパムメールを起点とする「ＷＥＲＤＬＯＤ」の感染ルート（トレンドマイクロによる）



　このＷＥＲＤＬＯＤの感染源はメールで、国内の大手通販サービスのメールアドレスをかたり、タイトルは「２０１５／０２／１０日付　ご注文№９５１８３２４４」などのように通販の受け付けメールを装っている。
　そして本文には「画像をダブルクリックして領収証をお受け取りください。」と日本語で書かれている。明らかに日本のユーザーを狙うものだ。
　この画像をダブルクリックすると、マルウェアは２つのことを実行する。





「ＷＥＲＤＬＯＤ」によるプロキシ設定。国内の大手金融機関４行・地銀１０行などへのアクセスを、犯人のサーバー経由にさせる（トレンドマイクロによる）



１：プロキシサーバーの設定を書き換える
　ブラウザーのプロキシサーバー（中継サーバー）の設定を書き換え。インターネットエクスプローラー、Ｃｈｒｏｍｅ、Ｆｉｒｅｆｏｘでのプロキシサーバー設定を書き換えて、特定のドメインだけを犯人のサーバーを経由するように設定する。





ＳＳＬ証明書のセキュリティー警告が出るはずだが、ユーザーが目にする前に「ＷＥＲＤＬＯＤ」によって自動で「はい」ボタンが強制的に押される（トレンドマイクロによる）



２：不正なルート証明書を入れて自動的に「はい」を押す
　銀行サイトでは電子証明書で接続先を証明しているため、プロキシサーバーの設定を書き換えただけでは、エラーが出てしまう。そこで犯人は、犯人が作った自己署名証明書を、ユーザーのパソコンやブラウザーの「信頼するルート証明書リスト」へ追加。さらに警告が出ても、画面に描画した瞬間に、自動的・強制的に「はい」を押すしくみになっていた。
　１のプロキシ設定書き換えでは、２６の日本のドメイン名がリストアップされていた。国内の大手金融機関４行、地銀１０行など複数のネットバンキング関連ドメインが含まれており、明らかに日本の銀行・日本のユーザーを狙ったものだ。
　また２の不正なルート証明書の手口は、無理やりな方法ではあるものの、発覚されにくいしくみになっている。勝手な自己署名証明書を入れるだけでなく、画像のようにセキュリティー警告が出ても、ユーザーが目にする前に勝手に「はい」を押してしまう。
　木村仁美氏は「ＳＳＬ／ＴＬＳはＭｉｔＭ攻撃（中間者攻撃）の回避策となるはずですが、不正なルート証明書を信頼してしまうことにより、それがかなわなくなるのです。しかしながらこのとき救われる点として、ＥＶ証明書を利用しているときのようにブラウザのアドレスバーは緑色にならないことが挙げられます。この点は、ユーザが異常に気付くきっかけにはなり得るでしょう。」としている。

　銀行の多くは、ＳＳＬサーバー証明書よりも厳格な審査があるＥＶ証明書（Ｅｘｔｅｎｄｅｄ　Ｖａｌｉｄａｔｉｏｎ）を導入している。ＥＶ証明書では、ブラウザーのアドレスバーが緑になるのが特徴だ。もしあなたが利用しているネットバンキングがＥＶ証明書を使っていれば（アドレスバーが緑）、緑になっているかどうか常に確認することが対策になるだろう。
対策ソフトを必ず更新、メール添付ファイルはクリックしない

　この「ＷＥＲＤＬＯＤ」は２０１４年１２月頃から国内でみつかり、２０１５年１月～３月にも約４００件の感染がみつかっている＝トレンドマイクロ「日本を標的とする新たなオンライン銀行詐欺ツール『ＷＥＲＤＬＯＤ（ワードロッド）』の手口を解説」。トレンドマイクロのユーザーだけでこの数だから、実際の感染者はさらに多いだろう。
　私たちユーザーの防御策をまとめておこう。
「ＷＥＲＤＬＯＤ」の防御策

・メールの添付ファイルを信用しない
　メールの添付ファイルは、開く前に本物かどうかよく考えること。通販サイトからのメールであっても信用しない。少しでも不安があったら、中止して本物かどうか問い合わせる。
・ネットバンキングではアドレスバーが緑になっているか確認
　多くの金融機関はアドレスバーが緑になるＥＶ証明書を採用している。自分の銀行がＥＶ証明書であるなら、アドレスバーが緑かどうか、常に確認するクセを付ける。
・セキュリティー対策ソフトを入れて更新する
　今回の「ＷＥＲＤＬＯＤ」は、トレンドマイクロのセキュリティー対策ソフトで検知できるほか、感染後でも不正なプロキシサーバーをブロックできる（Ｗｅｂレピュテーション機能）。セキュリティー対策ソフトを必ず導入し、有料ソフトでは必ず契約・更新しよう。
　なお感染後の処置としては、「ＷＥＲＤＬＯＤ」を削除するだけでなく、プロキシ設定や信頼済みルート証明書の削除などが必要だ。詳しくはトレンドマイクロの「日本を標的とする新たなオンライン銀行詐欺ツール『ＷＥＲＤＬＯＤ（ワードロッド）』の手口を解説」を参照してほしい。

2015年04月17日 15時32分
Copyright © The Yomiuri Shimbun



