

広告表示したら感染…ソフト最新化を急げ


2015年12月04日 18時06分










　ウェブサイトでよく目にするバナー広告が、オンラインバンキング詐欺ツールや、ファイルを勝手に暗号化するランサムウェア感染の原因になっている。バナー広告を表示しだけで感染するもので、対策には普段使っているソフトを最新化する必要がある。（ＩＴジャーナリスト・三上洋）

５０秒で感染→ランサムウェアで暗号化・脅迫





トレンドマイクロのシニアスペシャリスト・森本純氏。表示しただけで感染する不正広告について説明した




        AD2.init(ads.p_rectangle);
        

        AD2.cAds();
        

AD2.dBanner(0,'prect');




　この連載・サイバー護身術でも、繰り返し取り上げているウェブサイトの不正広告問題について、セキュリティー大手・トレンドマイクロが３日に記者向けセミナーを開催した。
　冒頭に衝撃的なデモンストレーションが行われた。トレンドマイクロが用意した環境で、実際に不正広告がどのように動くかを見せる動画デモだ。

★不正広告のデモンストレーション
１：ニュースサイト（トレンドマイクロが用意した仮想のもの）をブラウザーで表示。上と右にバナー広告が出ている
２：何もしていないのに、わずか５０秒後にウイルス感染
３：ハードディスクのファイルが暗号化されてしまい、読み取れなくなる
　サイトを表示しただけ、しかもわずか５０秒で、パソコンのファイルを勝手に暗号する不正プログラム・ランサムウェアの被害に遭ってしまった。以前から広告をクリックして感染する例はあったが、今回のように表示しただけで感染させる手口「ドライブ・バイ・ダウンロード」を使う不正広告は、今年に入って増えている。





















不正広告のデモンストレーション動画。バナー広告があるサイトを表示するだけで（左）、５０秒後に赤の部分のウイルスが動作（中）、ランサムウェアに感染しファイルが勝手に暗号化されてしまう（右）

　





不正広告による被害実態。３７００以上の日本語正規サイトにウイルス感染させようとする不正広告が表示されていた


　サイトは怪しいものではなく、一般向けの正規サイトだ。トレンドマイクロの調べによれば、今年だけで３７００以上のサイトで、この不正広告が表示されていた。表示していたサイトの内訳は、ブログ・Ｗｉｋｉ・レンタルＷｅｂなどのレンタル系サイトが６３％、企業・ビジネス系が７％、ニュースメディア・情報ポータルが４％で、この中には月間１００万ページビューを超える人気サイトもあった。
　不正広告が置かれた広告業者のサーバーには１０００万件以上のアクセスがあり、ウイルス感染させるサイト（脆弱(ぜいじゃく)性攻撃サイト）へのアクセスの４７％が日本からだった。つまり日本のウェブサイトを狙って、日本人に感染させようとするサイバー攻撃なのである。

料金払って広告出稿、古いソフトウェアの弱点突く手口

　なぜ、こんなことが起きるのか。手口のポイントは２つある。





不正広告の原因は、外部からの不正アクセス、もしくは犯人による正規ルートでの広告出稿のいずれか


●「カオス」状態の広告ネットワークを悪用
　この手口では、バナー広告のネットワークが使われている。トレンドマイクロのシニアスペシャリスト・森本純氏によると「犯人は不正アクセスで広告を改ざんしているか、お金を払って実際に正規の広告を出しているかのいずれか。通常の手段で広告を出しているのかもしれない」と分析している。
　ネット広告のしくみをまとめたのが下の図だ。インターネット上の広告は複雑で、複数の広告業者がネットワーク化されており、閲覧者の環境やサイトの内容によって、適切な広告が自動的に切り替わるしくみになっている。広告を受け付ける代理店、バナー広告の業者、それをネットワーク化する業者などが入り乱れて、カオスな状況なのだ。そのため「犯人にとっては追跡回避、私たちセキュリティー会社にとっては分析が難しくなるという状況」（森本氏）になっている。





バナー広告が複雑にネットワーク化されており、原因をつかむのがむずかしい


　不正広告でのウイルス感染は、犯人にとっても効率的だ。これまでサイトを通じたウイルス感染では、サイト改ざんによるものが多かった。犯人がセキュリティーの甘いウェブサイトに侵入し、サイトの内容を書き換えて感染させるコードを追加する手口だ。
　しかし広告を利用すると、広範囲にウイルスをバラまくことができる上に、ターゲットを絞ることができる。日本のユーザーだけを狙うことも可能だ。わざわざ企業のサイトに忍び込んで改ざんするよりも、広告利用の方が効率的にウイルスをバラまくことができるわけだ。

●弱点を発見するツールで感染させる
　表示した不正広告は、裏側で犯人が用意したウイルス感染させるためのサイト＝脆弱性攻撃サイトへ誘導している。脆弱性とは、私たちが使っているソフトで攻撃されると不正なプログラムの実行を許してしまう弱点のこと。ブラウザー上で使われている様々なプログラムに脆弱性が存在している。

　脆弱性攻撃サイトでは、複数のソフト・複数のバージョンに対応した攻撃ツール・エクスプロイトキットが動いている。このエクスプロイトキットは、訪れたユーザーが使っているＯＳ・ブラウザー・Flash・Javaなどのバージョンをチェックし、脆弱性があるものを見つけ出して感染させる。
　「抜け穴発見ツール」であると同時に、ウイルス感染させる万能ツールなのだ。１つでも脆弱性がみつかれば、そこを突いてオンライン銀行詐欺ツールや、ランサムウェアに感染させようする。

現金盗み出し、ファイル暗号化で脅迫も





不正広告経由で侵入する不正プログラム。オンライン銀行詐欺ツール、ランサムウェアなど、金銭を盗み取るものが目立つ


　この不正広告では、上のようなウイルスが侵入する。もっとも多いのはオンライン銀行詐欺ツールで４１％。パソコンに忍び込み、ネットバンキングにアクセスした時にパスワードを盗み取ったり、振込先を書き換えてお金を犯人の口座に勝手に送ったりするものだ。
　次に多いのはランサムウェアで１９％。パソコンのファイルを勝手に暗号化し「元に戻したければお金（多くの場合ビットコイン）を払え」と脅すものだ。森本氏によれば「ランサムウェアの具体的な被害は把握できていないが、これだけ多くの攻撃が行われていることを見ると、すでに実害が出ているだろう」と述べている。ファイルが暗号化されてしまうランサムウェアは、個人でも大きな被害を受けるので警戒が必要だろう。
　一般ユーザーの対策としては、２つある。１つは使っているソフトウェアを常に最新バージョンにすること。ＯＳ・ブラウザー・Java・Flash・PDFなどのソフトを自動更新の設定にして、警告が出たらすぐに更新しよう。２つ目は総合型のセキュリティー対策ソフトを使うこと。ウイルス検出だけでなく、怪しい動きをブロックする「ふるまい検知」、不審なサイトをブロックする機能があったほうがよい。
















対策は、利用しているソフトウェアを常に最新バージョンにすることと、総合型セキュリティー対策ソフトを導入することの２点

　
　広告業者側の対策も必要だろう。森本氏は「広告を表示しているサイト・広告配信業者は、不正な広告を出される被害者であると同時に、ユーザーに対しての加害者にもなっている。広告業界全体での取り組みも必要だ」と述べた。トレンドマイクロでは、インターネット広告団体とも協議を行っているとのこと。安心してサイトを閲覧できるように、早く不正広告を撲滅してほしい。


●参考記事
・ネット広告でウイルス感染、国内３千サイトに表示：サイバー護身術
・広告ウイルスと情報流出が拡大：７月－９月セキュリティー調査：サイバー護身術
・ランサムウェア拡散を狙うWeb改ざん、国内サイト70件以上で被害を確認：トレンドマイクロセキュリティブログ

2015年12月04日 18時06分
Copyright © The Yomiuri Shimbun



