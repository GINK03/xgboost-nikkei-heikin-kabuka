

ＪＴＢ流出ウイルスは中国製が濃厚


2016年06月24日 18時14分










　ＪＴＢからの個人情報７９３万件流出で使われたウイルスは、中国語表記であり、中国からの攻撃であることが濃厚との分析が出ている。巧妙な手口からウイルス付きメールの開封を防ぐことは難しく、ウイルスに感染することを前提とした対策が欠かせない。（ＩＴジャーナリスト・三上洋）
セキュリティー会社がデモンストレーション





ファイア・アイのシニアアナリスト・本城信輔氏。６月１７日にＪＴＢ流出と同じウイルスについてのセミナーを行った




        AD2.init(ads.p_rectangle);
        

        AD2.cAds();
        

AD2.dBanner(0,'prect');




　企業向けセキュリティー大手のファイア・アイが、ＪＴＢ流出で使われたウイルスについての記者向けセミナーを開いた（ＪＴＢ流出については以前の記事参照：ＪＴＢ個人情報７９３万件流出か？…標的型攻撃の巧妙な手口：サイバー護身術）。ファイア・アイのシニアアナリスト・本城信輔氏が、今回のウイルスが過去にどんな形で使われたか解説するものだ。
　先にウイルス（マルウェア）の名称について整理しておきたい。ＪＴＢ広報の発表は「ＰｌｕｇＸ（プラグエックス）」とされ、ファイア・アイも同じ名前を使っている。しかしながらこの名前はウイルスとは関係のない一般製品で使われており、登録商標にもなっている。そこで筆者の記事上では、ＰｌｕｇＸではなく「Ｋｏｒｐｌｕｇ（コープラグ）」という名称で呼ぶことにする。





ＪＴＢ流出と同じ遠隔操作ウイルスのツールキット画面。中国語になっている


　まず本城氏は、ＪＴＢ流出で使われた「Ｋｏｒｐｌｕｇ」のデモンストレーションを行った。２～３年前にセキュリティー研究者が入手したバージョンの「Ｋｏｒｐｌｕｇ」のツールキットを実際に動かし、感染させてみるデモンストレーションだ。ツールキットとは、ウイルス作成ツールのことで、作ったウイルスで感染先のパソコンの遠隔操作も可能になっている。
「中国語版Ｗｉｎｄｏｗｓでないと文字化け」

　デモで使ったパソコンは中国語版のＷｉｎｄｏｗｓだ。本城氏は「このウイルスは中国語版Ｗｉｎｄｏｗｓでないと文字化けをする。メニューはすべて中国語であり、中国語を理解できる人向けに作られている」とした。
　ウイルスの作成はとても簡単だ。指令用サーバーＩＰアドレス（ネット上の住所にあたるもの）などを入力し、作成ボタンを押すだけ。自分でプログラミングする必要はなく、ツールキットが専用のウイルスをワンタッチで作成してくれる。
　デモでは、このウイルスをパソコンに感染させた。するとパソコンのすべての情報が表示される。どんなソフトが動いているか、設定がどうなっているか丸ごと見える状態だ。
　そしてファイルの送受信も可能だ。ドラッグ＆ドロップするだけで指定したファイルを送り込み、プログラムも実行できてしまう。つまり後から自由に、様々なウイルスを送り込むことができるわけだ。このウイルスが入り込むと、遠隔操作でパソコンが自由自在にコントロールされてしまう。





設定項目さえ入力すればワンタッチでウイルスを作成できる。感染させたパソコンとのファイル送受信は、ドラッグ＆ドロップで簡単に操作可能









　このツールキットの特徴は、とてもわかりやすい操作体系であること。メニューがツリー形式で並び、設定項目も整理され、誰でも使えるように設計されている。まるで市販製品のようなデザインだ。これについて本城氏は「わかりやすい操作体系にする理由は、分業化にあると推測している。大規模な組織では、ウイルス作成や遠隔操作を分業で行うため、誰でもわかるようなスマートな画面にしているのではないか」と分析した。
フォントや手口から浮上する犯人像は





ＪＴＢ流出で使われたＫｏｒｐｌｕｇ（写真上はＰｌｕｇＸとの表記）は、中国製の遠隔操作ウイルス。２０１２年頃から使われており、日本への攻撃例は減っている









　本城氏はこの「Ｋｏｒｐｌｕｇ」について、今までわかっているポイントを整理した。
　まず「Ｋｏｒｐｌｕｇ」は最近減少傾向にあったという。「２０１４年はＫｏｒｐｌｕｇによる攻撃が多かったが、２０１５年は年金機構で使われたＥｍｄｉｖｉ（エムディヴィ）が圧倒的に多くなった。特に最近はＫｏｒｐｌｕｇは減ってきている。推測ではあるが、数が減っている方が対策が甘くなるため、そこを狙っているのかもしれない」と分析している。多くの攻撃事例があれば、セキュリティ会社による対策が厳重になるが、被害が少なければ対策をすり抜ける可能性があるということだ。





Ｋｏｒｐｌｕｇで使われたおとり文書。中国語のフォントが使われていた


　Ｋｏｒｐｌｕｇに感染させるための標的型攻撃メールでは、様々なおとり文書が使われている。犯人はウイルス感染させるために、普段の業務に似せたメールを作って企業の公開メールアドレスや社員のメールアドレスに送りつける。Ｋｏｒｐｌｕｇで使われたおとり文書は、ネット上で公開されているイベントの案内や企画書などが添付されていたほか、中国語フォントで作成されたファイルもあった。中国語の「ｓｉｍｓｕｎ（シムスン）」フォントが使われており、中国語環境のパソコンで作られたファイルだとわかる。
　また本城氏は、今まで「Ｋｏｒｐｌｕｇ」が使われた攻撃例を三つ紹介した。「日本のハイテク企業・製造業を狙った攻撃」「２０１５年７月に起きた日本のサイトへの水飲み場攻撃（関係者がよく見るサイトを改ざんしウイルス感染させる攻撃のこと）」「ハイテク、製造業、エネルギー、ＮＧＯ、軍事産業などを狙う攻撃」の三つがあったが、いずれも中国からの攻撃だと分析している。





Ｋｏｒｐｌｕｇを使った今までの攻撃は「中国が関与したもの」がほとんど本城氏は述べている


　これについて本城氏は「ツールキットの言語、Ｃ２サーバー（ウイルスに命令を送るサーバーのこと）のＩＰアドレスなどから、Ｋｏｒｐｌｕｇの攻撃は中国から行われている可能性が高い。」と分析している。
　ちなみにＪＴＢ流出では、もう一つ「ＥＬＩＲＫＳ」というウイルスも発見されている。ファイア・アイでは「Ｊａｍｂｏｘ（ジャムボックス）」と呼んでいるウイルスで、犯人からの命令のやり取り（Ｃ２サーバー）にミニブログを使うものだ。本城氏は「Ｊａｍｂｏｘは海外では見つかったことがなく、日本だけで発見されているウイルス。日本を狙った攻撃だと言えるだろう」と述べた。
　ＪＴＢ流出の犯人像について本城氏は「Ｋｏｒｐｌｕｇを使っているところから見て、中国からの攻撃の可能性が高いと考えている。中国からの攻撃グループは複数あることがわかっているが、どのグループなのかは判断できない。ただ個人情報を狙うという点から、日本年金機構を狙ったグループとの類似点が多いように思う」とした。
ウイルス感染は防げない～「感染前提の対策」が必要に

　本城氏は「今までの標的型攻撃は企業の機密情報（企業秘密）を狙うものだった。しかし日本年金機構流出が起きた昨年から、企業が持っている顧客の個人情報を狙う攻撃が増えてきた。盗んだ個人情報を何に使うのかは不明だが、次のサイバー攻撃の足場として使うか、もしくは個人情報の転売などの金銭目的の可能性もある。いずれにしても今後は、個人情報を持っている企業が狙われることが増えそうだ」とまとめた。
　今回のＪＴＢ流出では、航空会社のメールを装った文面で、航空券のチケットが添付されるなど巧妙なものだった。これについて本城氏は「メール本文だけで判断するのは不可能。よく『怪しいメールは開かない』と言うが、標的型攻撃メールのほとんどは怪しくないものであり、開封してしまう可能性が高い」とした。
　企業では標的型攻撃メール対策を進めているが、完全にシャットアウトすることは難しいというわけだ。「年金機構の流出では、最終的にたった１通のメール開封によって情報流出が起きた。たった１通でも流出が起きるため、パーフェクトに守り切ることは難しい」と本城氏は述べている。
　そのため企業では、ウイルス感染が起きるという前提での対策が必要だという。具体的には「組織全体でウイルス感染した場合の手順を決めておく」「監視・検知・隔離など感染後の対応を強化」「感染の演習を行う」「ネットワークの分離（重要情報を保管するサーバーとメールを開く端末を分離）」という四つを企業が実施すべきだとした。
　このように標的型攻撃は避けるのが難しく、今後も企業や団体からの情報流出が起きるだろう。個人情報を扱う企業は、セキュリティー対策を強化するとともに、「ウイルス感染を前提とした準備」が必要になってくる。私たち一般ユーザーには対策のしようがない事態だけに、企業・組織の責任は重い。ＪＴＢ流出の全貌を早く解明・公表し、今後の対策に生かしてほしいものだ。
参考記事

・ＪＴＢ個人情報７９３万件流出か？…標的型攻撃の巧妙な手口：サイバー護身術・知らぬ間に被害～標的型サイバー攻撃活発化：サイバー護身術

2016年06月24日 18時14分
Copyright © The Yomiuri Shimbun



