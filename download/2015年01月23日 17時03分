

２０００件のＩＤ入手、クレカ不正利用の容疑者逮捕


2015年01月23日 17時03分










　不正入手したＩＤ・パスワードなどを使って大手通販サイトにログインし、無断で買い物をしたとして、容疑者が逮捕された。
　「ＳＱＬインジェクション」と呼ばれる攻撃によってＩＤ・パスワードを入手し、それを他の通販サイトのＩＤ・パスワードに当てはめたものだ。（ＩＴジャーナリスト・三上洋）
「ＳＱＬインジェクション」と「パスワードリスト攻撃」の合わせ技？





容疑者は他のサイトへの攻撃で入手したＩＤ・パスワードを使い、楽天市場にログインし、クレジットカードを不正利用した




        AD2.init(ads.p_rectangle);
        

        AD2.cAds();
        

AD2.dBanner(0,'prect');




　警視庁サイバー犯罪対策課は１月２２日に、他人のクレジットカードで商品を購入したとして川崎市多摩区の２０歳の容疑者を逮捕した。昨年１１月から１２月にかけて、北九州市の８０歳代女性のＩＤ・パスワードで大手通販サイト「楽天市場」にログインし、女性のクレジットカード情報を使ってスマートフォン１台（約４万２８００円）を購入した疑いだ。
　容疑者は容疑を認めており、「ほかにも他人のカードで買い物した。総額は多すぎて見当もつかない」と供述している。容疑者の自宅などからスマートフォン約７０台が押収されており、他にも余罪があると見られている。
サイトの不備突く「古典的」手法…ＳＱＬインジェクション

　この事件だが、ポイントは大きく分けて２つある。１つは「ＳＱＬインジェクション」によって、他のサイトからＩＤ・パスワードを入手したこと。２つ目は、それを楽天市場のＩＤ・パスワードに当てはめて不正購入する「パスワードリスト攻撃」だったことである。
　まず１つ目だが、容疑者は昨年ご当地グルメを検索できる会員サイトに対して、ＳＱＬインジェクション攻撃と呼ばれる攻撃をかけ、ＩＤ・パスワードを盗みとっている。報道によれば、これ以外にも約３０のサイトに同様のサイバー攻撃を行ったとのこと。合わせて約２０００件のＩＤ・パスワードを入手した模様だ。
　ＳＱＬインジェクションとは、ウェブサイトで使われているデータベースを処理する際に、不正なコードなどを入れることにより、情報を盗み取ったり、書き換えたりする攻撃のこと。ウェブサイトで動いているアプリケーションの不備を突かれ、外部から情報を盗みとられたり、書き換えられたりすることが多い。
　古典的なウェブサイトへの攻撃手法だが、不備のあるウェブサイト（ウェブサイト上で動しているアプリケーションの不備）が多いために、今も多くの攻撃が行われている。たとえばＩＰＡの「２０１４年度　情報セキュリティ事象被害状況調査（ＰＤＦ文書）」によると、サイバー攻撃の手口の中で４番目に多いのがＳＱＬインジェクションとなっている（１位ＤｏＳ攻撃４３．２％、２位標的型攻撃３０．４％、３位脆弱(ぜいじゃく)性１５．８％、４位ＳＱＬインジェクション９．２％）。
　今回の事件では、ご当地グルメを扱う会員制サイトが狙われたが、データベースを利用しているサイトは数多くあり、不備があればＳＱＬインジェクション攻撃の被害に遭う可能性がある。サイト運営会社だけでなく、サイトの制作業者の責任問題にもなるだろう（後述）。
使い回しが根本原因…パスワードリスト攻撃

　この事件の２つ目のポイントは「パスワードリスト攻撃」だ。
　容疑者は攻撃によって会員サイトで入手したＩＤ・パスワードを、他のサイトで使えないか試したのであろう。それでログインできたのが、楽天市場だったことになる。被害者である８０歳代の女性は、ご当地グルメの会員サイトと、楽天市場で同じＩＤとパスワード（もしくはどちらかのみ）を使っていた。そのために楽天市場での不正利用を許してしまったことになる。
　いわゆる「パスワードリスト攻撃」と呼ばれるもので、他のサイトから入手したＩＤ・パスワードのリストを、他のサイトに当てはめて不正利用するものだ。
　根本的な原因は、私たちユーザーが、パスワードを使い回してしまうことにある。セキュリティー大手・トレンドマイクロが、昨年６月にパスワードの利用実態調査を行っているが、それによると９３．１％ものユーザーがパスワードを使い回していた。１種類のパスワード使い回しが１５．８％、２～３種類のパスワード使い回しが５６．４％もあり、合わせて約７割のユーザーが「３つ以下のパスワードを使い回している」というのが実態だ（パスワードの利用実態調査２０１４：トレンドマイクロ）。
　ＩＤ・パスワードを使うサイトが多すぎて、かつ覚えきれないために使い回している人がいるのだが、それが今回のような不正利用事件の原因となっている。
　パスワードリスト攻撃については、以前の記事「ＬＩＮＥ乗っ取りの原因、パスワードリスト攻撃とは」で詳しく取り上げている。今回の事件は、容疑者が「パスワード入手」と「不正利用」の両方を行っていたが、ネットの裏市場ではパスワードリストが販売されていると言われており、それを購入すれば簡単にパスワードリスト攻撃を実行できてしまうという問題がある。
パスワードの「棚卸し」に加えて、運営側の対策がカギ

　ユーザー側の対策としては「パスワードの使い回しをやめる」ことがもっとも重要だ。一つ一つのサービスごとにパスワードを別のものにすること。とても時間がかかるが、安全のためにはやむを得ない。筆者はこの作業を「パスワードの棚卸し」と読んでいるが、１日かけて棚卸しをしっかりやってほしい。
　その上でＩＤ・パスワードは、エクセルなどの表計算ソフトにまとめてパスワードをかけるか、紙にメモとして書いて保存する。表計算ソフトやメモにすることはリスクがあるが、それでも使い回すよりは安全度が高いからだ。もっとスマートにパスワード管理をしたい人は、有料にはなるがパスワード管理ソフト（１Ｐａｓｓｗｏｒｄなど）を使うといいだろう。
　企業やサイト運営側としては、ＳＱＬインジェクション攻撃への対策が不可欠だ。サイト上で動いているアプリケーションを見直し、安全度を高めることが重要になる。
　ＳＱＬインジェクション攻撃については、被害に遭った企業が、サイトを制作した業者を相手にした訴訟を起こし、２２６２万円余りの賠償を認めた判決が出た事例もある（徳丸浩氏による記事「ＳＱＬインジェクション対策もれの責任を開発会社に問う判決」参照）。サイト制作会社も、ＳＱＬインジェクション攻撃を許さないように、ウェブアプリケーションの安全度を高める努力が必要だ。

2015年01月23日 17時03分
Copyright © The Yomiuri Shimbun



